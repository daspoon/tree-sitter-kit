# TreeSitterKit

This project aims to simplify the use of the [tree-sitter](https://tree-sitter.github.io/tree-sitter/) parser generator for implementing custom programming languages in [Swift](https://swift.org).
More specifically, through use of Swift macros, it enables writing grammar rules as Swift code and automates translation of parse trees into the Swift data structures which implement your abstract syntax.

Example applications are given in the test targets ExprLang and TypedLang.
These examples are complicated by the cyclic nature of the task -- the grammar is derived from the language implementation types, the parsing code is generated by the tree-sitter CLI, and we want both to reside in the same compilation unit. 
This currently requires an application be split into a 'language' target which defines an abstract syntax and a 'parser' target which contains the grammar description and the generated parser source (for ExprLang, the language target is located in Tests/ExprLang and the parser target is located in Source/Examples/ExprLang).
Further, parser generation is performed by a command plugin (TSGen) which redirects the output of `tree-sitter generate` to the parser source directory.
Consequently, updating the parser to reflect changes to the grammar rules requires manually copying the grammar source from the macro expansion into the grammar.json file of the parser target, running the command plugin,
  ```
  $ swift package generate-parser --target ExprLang
  ```
and then building.

This is a work in progress. My efforts are currently focused on streamlining the build process. Some suggestions for contribution are listed in TODO.md, the most important of which is using the package to implement parsers for other languages.


## Additional notes

See the following links for more information on tree-sitter:
  - Github project: https://github.com/tree-sitter/tree-sitter
  - Intro video: https://news.ycombinator.com/item?id=18213022
  - Getting started: https://tree-sitter.github.io/tree-sitter

While existing packages (https://github.com/ChimeHQ/SwiftTreeSitter and https://github.com/viktorstrate/swift-tree-sitter) provide Swift bindings for tree-sitter APIs, they do not directly support building custom language targets.
Further, these packages bundle parsers for various existing languages which are not required for our purposes; ideally a language parser should be provided as a package independent of the tree-sitter API bindings.
